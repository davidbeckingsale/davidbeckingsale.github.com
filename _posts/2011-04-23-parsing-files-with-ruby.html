--- 
layout: post
title: Parsing Files with Ruby
tags: 
- Programming
- programming
- ruby
status: publish
type: post
published: true
meta: 
  _edit_last: "1"
  _syntaxhighlighter_encoded: "1"
  _pingme: "1"
  _encloseme: "1"
---
I'm coming to the end of my final year project, and have been running a lot of performance tests. This involves running the same program on multiple node configurations. The result of all this is a <em>lot</em> of text ending up in a lot of files. The programs don't just spit out a runtime, they dump a lot of information related to the solution the process has calculated.

Because of the large amount of text that I would have had to trawl through, I decided to try and do it with a script.

I've been learning a little bit of Ruby on Rails recently, so I decided to give that a whirl. It's nothing special, just a quick and dirty regex script with Ruby. It's a nice way to see how Ruby can interact with system type stuff.
The code I used was:

[code]
file=ARGV.first&lt;/p&gt;

&lt;p&gt;decomp_regex = /\s&lt;em&gt;[0-9]+\s&lt;/em&gt;domains\s&lt;em&gt;-\s&lt;/em&gt;([0-9]+)\s&lt;em&gt;x\s&lt;/em&gt;[0-9]\s&lt;em&gt;decomposition/
time_regex = /\s&lt;/em&gt;CPU\s&lt;em&gt;time\s&lt;/em&gt;was:\s&lt;em&gt;([0-9]&lt;/em&gt;&amp;#46;[0-9]+|[0-9]+)/&lt;/p&gt;

&lt;p&gt;File.readlines(file).each do |line|
 if (m = decomp_regex.match line)
 print m[1]
 end
 if (m = time_regex.match line)
 print &quot;,#{m[1]}\n&quot;
 end
end
[/code]

Like I said, nothing fancy. Just searches for lines of the form "25 domains - 5 x 5 decomposition" and rips out the first number of the "N x N" and prints it. The second regex looks for lines like "CPU time was: 903.231", and takes the time and puts that after the first number. This basically is generating lines like "5, 903.321" which are used for plotting in gnuplot.

It's not big and it's not clever, but it's saved me a bunch of time over the past couple of days generating files for plotting.
